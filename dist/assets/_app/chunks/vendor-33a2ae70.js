function q(){}const Bt=t=>t;function rn(t,e){for(const n in e)t[n]=e[n];return t}function de(t){return t()}function ve(){return Object.create(null)}function H(t){t.forEach(de)}function Ut(t){return typeof t=="function"}function an(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let xt;function br(t,e){return xt||(xt=document.createElement("a")),xt.href=e,t===xt.href}function on(t){return Object.keys(t).length===0}function sn(t,...e){if(t==null)return q;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Er(t,e,n){t.$$.on_destroy.push(sn(e,n))}function Tr(t,e,n,r){if(t){const i=pe(t,e,n,r);return t[0](i)}}function pe(t,e,n,r){return t[1]&&r?rn(n.ctx.slice(),t[1](r(e))):n.ctx}function Nr(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const a=[],o=Math.max(e.dirty.length,i.length);for(let u=0;u<o;u+=1)a[u]=e.dirty[u]|i[u];return a}return e.dirty|i}return e.dirty}function Or(t,e,n,r,i,a){if(i){const o=pe(e,n,r,a);t.p(o,i)}}function $r(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Pr(t,e,n){return t.set(n),e}const ye=typeof window!="undefined";let ge=ye?()=>window.performance.now():()=>Date.now(),qt=ye?t=>requestAnimationFrame(t):q;const V=new Set;function me(t){V.forEach(e=>{e.c(t)||(V.delete(e),e.f())}),V.size!==0&&qt(me)}function xe(t){let e;return V.size===0&&qt(me),{promise:new Promise(n=>{V.add(e={c:t,f:n})}),abort(){V.delete(e)}}}let wt=!1;function un(){wt=!0}function fn(){wt=!1}function cn(t,e,n,r){for(;t<e;){const i=t+(e-t>>1);n(i)<=r?t=i+1:e=i}return t}function ln(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes;if(t.nodeName==="HEAD"){const s=[];for(let f=0;f<e.length;f++){const l=e[f];l.claim_order!==void 0&&s.push(l)}e=s}const n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let i=0;for(let s=0;s<e.length;s++){const f=e[s].claim_order,l=(i>0&&e[n[i]].claim_order<=f?i+1:cn(1,i,c=>e[n[c]].claim_order,f))-1;r[s]=n[l]+1;const h=l+1;n[h]=s,i=Math.max(h,i)}const a=[],o=[];let u=e.length-1;for(let s=n[i]+1;s!=0;s=r[s-1]){for(a.push(e[s-1]);u>=s;u--)o.push(e[u]);u--}for(;u>=0;u--)o.push(e[u]);a.reverse(),o.sort((s,f)=>s.claim_order-f.claim_order);for(let s=0,f=0;s<o.length;s++){for(;f<a.length&&o[s].claim_order>=a[f].claim_order;)f++;const l=f<a.length?a[f]:null;t.insertBefore(o[s],l)}}function hn(t,e){t.appendChild(e)}function we(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function dn(t){const e=_e("style");return vn(we(t),e),e}function vn(t,e){hn(t.head||t,e)}function pn(t,e){if(wt){for(ln(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentElement!==t)&&(t.actual_end_child=t.firstChild);t.actual_end_child!==null&&t.actual_end_child.claim_order===void 0;)t.actual_end_child=t.actual_end_child.nextSibling;e!==t.actual_end_child?(e.claim_order!==void 0||e.parentNode!==t)&&t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling}else(e.parentNode!==t||e.nextSibling!==null)&&t.appendChild(e)}function Ar(t,e,n){wt&&!n?pn(t,e):(e.parentNode!==t||e.nextSibling!=n)&&t.insertBefore(e,n||null)}function yn(t){t.parentNode.removeChild(t)}function jr(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function _e(t){return document.createElement(t)}function gn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Jt(t){return document.createTextNode(t)}function Dr(){return Jt(" ")}function Rr(){return Jt("")}function Lr(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Ir(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function mn(t){return Array.from(t.childNodes)}function xn(t){t.claim_info===void 0&&(t.claim_info={last_index:0,total_claimed:0})}function Se(t,e,n,r,i=!1){xn(t);const a=(()=>{for(let o=t.claim_info.last_index;o<t.length;o++){const u=t[o];if(e(u)){const s=n(u);return s===void 0?t.splice(o,1):t[o]=s,i||(t.claim_info.last_index=o),u}}for(let o=t.claim_info.last_index-1;o>=0;o--){const u=t[o];if(e(u)){const s=n(u);return s===void 0?t.splice(o,1):t[o]=s,i?s===void 0&&t.claim_info.last_index--:t.claim_info.last_index=o,u}}return r()})();return a.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1,a}function be(t,e,n,r){return Se(t,i=>i.nodeName===e,i=>{const a=[];for(let o=0;o<i.attributes.length;o++){const u=i.attributes[o];n[u.name]||a.push(u.name)}a.forEach(o=>i.removeAttribute(o))},()=>r(e))}function Cr(t,e,n){return be(t,e,n,_e)}function Mr(t,e,n){return be(t,e,n,gn)}function wn(t,e){return Se(t,n=>n.nodeType===3,n=>{const r=""+e;if(n.data.startsWith(r)){if(n.data.length!==r.length)return n.splitText(r.length)}else n.data=r},()=>Jt(e),!0)}function kr(t){return wn(t," ")}function Fr(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function zr(t,e){t.value=e==null?"":e}function Ee(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}const Gt=new Set;let _t=0;function _n(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Te(t,e,n,r,i,a,o,u=0){const s=16.666/r;let f=`{
`;for(let p=0;p<=1;p+=s){const w=e+(n-e)*a(p);f+=p*100+`%{${o(w,1-w)}}
`}const l=f+`100% {${o(n,1-n)}}
}`,h=`__svelte_${_n(l)}_${u}`,c=we(t);Gt.add(c);const d=c.__svelte_stylesheet||(c.__svelte_stylesheet=dn(t).sheet),y=c.__svelte_rules||(c.__svelte_rules={});y[h]||(y[h]=!0,d.insertRule(`@keyframes ${h} ${l}`,d.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${h} ${r}ms linear ${i}ms 1 both`,_t+=1,h}function Xt(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?a=>a.indexOf(e)<0:a=>a.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),_t-=i,_t||Sn())}function Sn(){qt(()=>{_t||(Gt.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),Gt.clear())})}let St;function bt(t){St=t}function Et(){if(!St)throw new Error("Function called outside component initialization");return St}function Br(t){Et().$$.on_mount.push(t)}function Ur(t){Et().$$.after_update.push(t)}function qr(){const t=Et();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=Ee(e,n);r.slice().forEach(a=>{a.call(t,i)})}}}function Jr(t,e){Et().$$.context.set(t,e)}const at=[],Ne=[],Tt=[],Oe=[],bn=Promise.resolve();let Yt=!1;function En(){Yt||(Yt=!0,bn.then($e))}function ot(t){Tt.push(t)}let Wt=!1;const Ht=new Set;function $e(){if(!Wt){Wt=!0;do{for(let t=0;t<at.length;t+=1){const e=at[t];bt(e),Tn(e.$$)}for(bt(null),at.length=0;Ne.length;)Ne.pop()();for(let t=0;t<Tt.length;t+=1){const e=Tt[t];Ht.has(e)||(Ht.add(e),e())}Tt.length=0}while(at.length);for(;Oe.length;)Oe.pop()();Yt=!1,Wt=!1,Ht.clear()}}function Tn(t){if(t.fragment!==null){t.update(),H(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ot)}}let st;function Pe(){return st||(st=Promise.resolve(),st.then(()=>{st=null})),st}function Nt(t,e,n){t.dispatchEvent(Ee(`${e?"intro":"outro"}${n}`))}const Ot=new Set;let G;function Gr(){G={r:0,c:[],p:G}}function Xr(){G.r||H(G.c),G=G.p}function Nn(t,e){t&&t.i&&(Ot.delete(t),t.i(e))}function Yr(t,e,n,r){if(t&&t.o){if(Ot.has(t))return;Ot.add(t),G.c.push(()=>{Ot.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}const Ae={duration:0};function Wr(t,e,n){let r=e(t,n),i=!1,a,o,u=0;function s(){a&&Xt(t,a)}function f(){const{delay:h=0,duration:c=300,easing:d=Bt,tick:y=q,css:m}=r||Ae;m&&(a=Te(t,0,1,c,h,d,m,u++)),y(0,1);const p=ge()+h,w=p+c;o&&o.abort(),i=!0,ot(()=>Nt(t,!0,"start")),o=xe(g=>{if(i){if(g>=w)return y(1,0),Nt(t,!0,"end"),s(),i=!1;if(g>=p){const _=d((g-p)/c);y(_,1-_)}}return i})}let l=!1;return{start(){l||(l=!0,Xt(t),Ut(r)?(r=r(),Pe().then(f)):f())},invalidate(){l=!1},end(){i&&(s(),i=!1)}}}function Hr(t,e,n){let r=e(t,n),i=!0,a;const o=G;o.r+=1;function u(){const{delay:s=0,duration:f=300,easing:l=Bt,tick:h=q,css:c}=r||Ae;c&&(a=Te(t,1,0,f,s,l,c));const d=ge()+s,y=d+f;ot(()=>Nt(t,!1,"start")),xe(m=>{if(i){if(m>=y)return h(0,1),Nt(t,!1,"end"),--o.r||H(o.c),!1;if(m>=d){const p=l((m-d)/f);h(1-p,p)}}return i})}return Ut(r)?Pe().then(()=>{r=r(),u()}):u(),{end(s){s&&r.tick&&r.tick(1,0),i&&(a&&Xt(t,a),i=!1)}}}function Vr(t,e){const n={},r={},i={$$scope:1};let a=t.length;for(;a--;){const o=t[a],u=e[a];if(u){for(const s in o)s in u||(r[s]=1);for(const s in u)i[s]||(n[s]=u[s],i[s]=1);t[a]=u}else for(const s in o)i[s]=1}for(const o in r)o in n||(n[o]=void 0);return n}function Kr(t){return typeof t=="object"&&t!==null?t:{}}function Qr(t){t&&t.c()}function Zr(t,e){t&&t.l(e)}function On(t,e,n,r){const{fragment:i,on_mount:a,on_destroy:o,after_update:u}=t.$$;i&&i.m(e,n),r||ot(()=>{const s=a.map(de).filter(Ut);o?o.push(...s):H(s),t.$$.on_mount=[]}),u.forEach(ot)}function $n(t,e){const n=t.$$;n.fragment!==null&&(H(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Pn(t,e){t.$$.dirty[0]===-1&&(at.push(t),En(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ti(t,e,n,r,i,a,o,u=[-1]){const s=St;bt(t);const f=t.$$={fragment:null,ctx:null,props:a,update:q,not_equal:i,bound:ve(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:ve(),dirty:u,skip_bound:!1,root:e.target||s.$$.root};o&&o(f.root);let l=!1;if(f.ctx=n?n(t,e.props||{},(h,c,...d)=>{const y=d.length?d[0]:c;return f.ctx&&i(f.ctx[h],f.ctx[h]=y)&&(!f.skip_bound&&f.bound[h]&&f.bound[h](y),l&&Pn(t,h)),c}):[],f.update(),l=!0,H(f.before_update),f.fragment=r?r(f.ctx):!1,e.target){if(e.hydrate){un();const h=mn(e.target);f.fragment&&f.fragment.l(h),h.forEach(yn)}else f.fragment&&f.fragment.c();e.intro&&Nn(t.$$.fragment),On(t,e.target,e.anchor,e.customElement),fn(),$e()}bt(s)}class ei{$destroy(){$n(this,1),this.$destroy=q}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!on(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const K=[];function ni(t,e=q){let n;const r=new Set;function i(u){if(an(t,u)&&(t=u,n)){const s=!K.length;for(const f of r)f[1](),K.push(f,t);if(s){for(let f=0;f<K.length;f+=2)K[f][0](K[f+1]);K.length=0}}}function a(u){i(u(t))}function o(u,s=q){const f=[u,s];return r.add(f),r.size===1&&(n=e(i)||q),u(t),()=>{r.delete(f),r.size===0&&(n(),n=null)}}return{set:i,update:a,subscribe:o}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var v=function(){return v=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},v.apply(this,arguments)};function Vt(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function b(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function O(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function I(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}var je=".",De={},Kt="xstate.guard",An="",ut=!0;function j(t){return Object.keys(t)}function Qt(t,e,n){n===void 0&&(n=je);var r=ft(t,n),i=ft(e,n);return E(i)?E(r)?i===r:!1:E(r)?r in i:j(r).every(function(a){return a in i?Qt(r[a],i[a]):!1})}function Re(t){try{return E(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function Zt(t,e){try{return Q(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function jn(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function ft(t,e){if(jn(t))return t.value;if(Q(t))return $t(t);if(typeof t!="string")return t;var n=Zt(t,e);return $t(n)}function $t(t){if(t.length===1)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)r===t.length-2?n[t[r]]=t[r+1]:(n[t[r]]={},n=n[t[r]]);return e}function ct(t,e){for(var n={},r=j(t),i=0;i<r.length;i++){var a=r[i];n[a]=e(t[a],a,t,i)}return n}function Le(t,e,n){var r,i,a={};try{for(var o=b(j(t)),u=o.next();!u.done;u=o.next()){var s=u.value,f=t[s];!n(f)||(a[s]=e(f,s,t))}}catch(l){r={error:l}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}var Dn=function(t){return function(e){var n,r,i=e;try{for(var a=b(t),o=a.next();!o.done;o=a.next()){var u=o.value;i=i[u]}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}};function Rn(t,e){return function(n){var r,i,a=n;try{for(var o=b(t),u=o.next();!u.done;u=o.next()){var s=u.value;a=a[e][s]}}catch(f){r={error:f}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}}function Pt(t){if(!t)return[[]];if(E(t))return[[t]];var e=D(j(t).map(function(n){var r=t[n];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[n]]:Pt(t[n]).map(function(i){return[n].concat(i)})}));return e}function D(t){var e;return(e=[]).concat.apply(e,I([],O(t),!1))}function Ie(t){return Q(t)?t:[t]}function U(t){return t===void 0?[]:Ie(t)}function At(t,e,n){var r,i;if($(t))return t(e,n.data);var a={};try{for(var o=b(Object.keys(t)),u=o.next();!u.done;u=o.next()){var s=u.value,f=t[s];$(f)?a[s]=f(e,n.data):a[s]=f}}catch(l){r={error:l}}finally{try{u&&!u.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function Ln(t){return/^(done|error)\./.test(t)}function Ce(t){return!!(t instanceof Promise||t!==null&&($(t)||typeof t=="object")&&$(t.then))}function In(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Me(t,e){var n,r,i=O([[],[]],2),a=i[0],o=i[1];try{for(var u=b(t),s=u.next();!s.done;s=u.next()){var f=s.value;e(f)?a.push(f):o.push(f)}}catch(l){n={error:l}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return[a,o]}function ke(t,e){return ct(t.states,function(n,r){if(!!n){var i=(E(e)?void 0:e[r])||(n?n.current:void 0);if(!!i)return{current:i,states:ke(n,i)}}})}function Cn(t,e){return{current:e,states:ke(t,e)}}function Fe(t,e,n,r){var i=t&&n.reduce(function(a,o){var u,s,f=o.assignment,l={state:r,action:o,_event:e},h={};if($(f))h=f(a,e.data,l);else try{for(var c=b(j(f)),d=c.next();!d.done;d=c.next()){var y=d.value,m=f[y];h[y]=$(m)?m(a,e.data,l):m}}catch(p){u={error:p}}finally{try{d&&!d.done&&(s=c.return)&&s.call(c)}finally{if(u)throw u.error}}return Object.assign({},a,h)},t);return i}var lt=function(){};function Q(t){return Array.isArray(t)}function $(t){return typeof t=="function"}function E(t){return typeof t=="string"}function ze(t,e){if(!!t)return E(t)?{type:Kt,name:t,predicate:e?e[t]:void 0}:$(t)?{type:Kt,name:t.name,predicate:t}:t}function Mn(t){try{return"subscribe"in t&&$(t.subscribe)}catch{return!1}}var kn=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function X(t){try{return"__xstatenode"in t}catch{return!1}}function Fn(t){return!!t&&typeof t.send=="function"}function te(t,e){return E(t)||typeof t=="number"?v({type:t},e):t}function k(t,e){if(!E(t)&&"$$type"in t&&t.$$type==="scxml")return t;var n=te(t);return v({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function Z(t,e){var n=Ie(e).map(function(r){return typeof r=="undefined"||typeof r=="string"||X(r)?{target:r,event:t}:v(v({},r),{event:t})});return n}function zn(t){if(!(t===void 0||t===An))return U(t)}function Be(t,e,n,r,i){var a=t.options.guards,o={state:i,cond:e,_event:r};if(e.type===Kt)return((a==null?void 0:a[e.name])||e.predicate)(n,r.data,o);var u=a[e.type];if(!u)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return u(n,r.data,o)}function Ue(t){return typeof t=="string"?{type:t}:t}function qe(t,e,n){if(typeof t=="object")return t;var r=function(){};return{next:t,error:e||r,complete:n||r}}var P;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(P||(P={}));var ht;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(ht||(ht={}));var ee=P.Start,ne=P.Stop,jt=P.Raise,Dt=P.Send,Je=P.Cancel,Bn=P.NullEvent,re=P.Assign;P.After;P.DoneState;var Ge=P.Log,Un=P.Init,ie=P.Invoke;P.ErrorExecution;var Xe=P.ErrorPlatform,qn=P.ErrorCustom,Ye=P.Update,Jn=P.Choose,Gn=P.Pure,Rt=k({type:Un});function ae(t,e){return e&&e[t]||void 0}function dt(t,e){var n;if(E(t)||typeof t=="number"){var r=ae(t,e);$(r)?n={type:t,exec:r}:r?n=r:n={type:t,exec:void 0}}else if($(t))n={type:t.name||t.toString(),exec:t};else{var r=ae(t.type,e);if($(r))n=v(v({},t),{exec:r});else if(r){var i=r.type||t.type;n=v(v(v({},r),t),{type:i})}else n=t}return n}var Lt=function(t,e){if(!t)return[];var n=Q(t)?t:[t];return n.map(function(r){return dt(r,e)})};function oe(t){var e=dt(t);return v(v({id:E(t)?t:e.id},e),{type:e.type})}function Xn(t){return E(t)?{type:jt,event:t}:We(t,{to:ht.Internal})}function Yn(t){return{type:jt,_event:k(t.event)}}function We(t,e){return{to:e?e.to:void 0,type:Dt,event:$(t)?t:te(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:$(t)?t.name:Re(t)}}function Wn(t,e,n,r){var i={_event:n},a=k($(t.event)?t.event(e,n.data,i):t.event),o;if(E(t.delay)){var u=r&&r[t.delay];o=$(u)?u(e,n.data,i):u}else o=$(t.delay)?t.delay(e,n.data,i):t.delay;var s=$(t.to)?t.to(e,n.data,i):t.to;return v(v({},t),{to:s,_event:a,event:a.data,delay:o})}var Hn=function(t,e,n){return v(v({},t),{value:E(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})},Vn=function(t){return{type:Je,sendId:t}};function Kn(t){var e=oe(t);return{type:P.Start,activity:e,exec:void 0}}function Qn(t){var e=$(t)?t:oe(t);return{type:P.Stop,activity:e,exec:void 0}}function Zn(t,e,n){var r=$(t.activity)?t.activity(e,n.data):t.activity,i=typeof r=="string"?{id:r}:r,a={type:P.Stop,activity:i};return a}var ri=function(t){return{type:re,assignment:t}};function tr(t,e){var n=e?"#".concat(e):"";return"".concat(P.After,"(").concat(t,")").concat(n)}function It(t,e){var n="".concat(P.DoneState,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function Ct(t,e){var n="".concat(P.DoneInvoke,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function vt(t,e){var n="".concat(P.ErrorPlatform,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function se(t,e,n,r,i,a){a===void 0&&(a=!1);var o=O(a?[[],i]:Me(i,function(c){return c.type===re}),2),u=o[0],s=o[1],f=u.length?Fe(n,r,u,e):n,l=a?[n]:void 0,h=D(s.map(function(c){var d;switch(c.type){case jt:return Yn(c);case Dt:var y=Wn(c,f,r,t.options.delays);return y;case Ge:return Hn(c,f,r);case Jn:{var m=c,p=(d=m.conds.find(function(R){var C=ze(R.cond,t.options.guards);return!C||Be(t,C,f,r,e)}))===null||d===void 0?void 0:d.actions;if(!p)return[];var w=O(se(t,e,f,r,Lt(U(p),t.options.actions),a),2),g=w[0],_=w[1];return f=_,l==null||l.push(f),g}case Gn:{var p=c.get(f,r.data);if(!p)return[];var A=O(se(t,e,f,r,Lt(U(p),t.options.actions),a),2),N=A[0],L=A[1];return f=L,l==null||l.push(f),N}case ne:return Zn(c,f,r);case re:{f=Fe(f,r,[c],e),l==null||l.push(f);break}default:var S=dt(c,t.options.actions),x=S.exec;if(x&&l){var T=l.length-1;S=v(v({},S),{exec:function(R){for(var C=[],M=1;M<arguments.length;M++)C[M-1]=arguments[M];x.apply(void 0,I([l[T]],O(C),!1))}})}return S}}).filter(function(c){return!!c}));return[h,f]}var Mt=function(t){return t.type==="atomic"||t.type==="final"};function tt(t){return j(t.states).map(function(e){return t.states[e]})}function He(t){var e=[t];return Mt(t)?e:e.concat(D(tt(t).map(He)))}function et(t,e){var n,r,i,a,o,u,s,f,l=new Set(t),h=ue(l),c=new Set(e);try{for(var d=b(c),y=d.next();!y.done;y=d.next())for(var m=y.value,p=m.parent;p&&!c.has(p);)c.add(p),p=p.parent}catch(T){n={error:T}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var w=ue(c);try{for(var g=b(c),_=g.next();!_.done;_=g.next()){var m=_.value;if(m.type==="compound"&&(!w.get(m)||!w.get(m).length))h.get(m)?h.get(m).forEach(function(R){return c.add(R)}):m.initialStateNodes.forEach(function(R){return c.add(R)});else if(m.type==="parallel")try{for(var A=(o=void 0,b(tt(m))),N=A.next();!N.done;N=A.next()){var L=N.value;L.type!=="history"&&(c.has(L)||(c.add(L),h.get(L)?h.get(L).forEach(function(R){return c.add(R)}):L.initialStateNodes.forEach(function(R){return c.add(R)})))}}catch(R){o={error:R}}finally{try{N&&!N.done&&(u=A.return)&&u.call(A)}finally{if(o)throw o.error}}}}catch(T){i={error:T}}finally{try{_&&!_.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}try{for(var S=b(c),x=S.next();!x.done;x=S.next())for(var m=x.value,p=m.parent;p&&!c.has(p);)c.add(p),p=p.parent}catch(T){s={error:T}}finally{try{x&&!x.done&&(f=S.return)&&f.call(S)}finally{if(s)throw s.error}}return c}function Ve(t,e){var n=e.get(t);if(!n)return{};if(t.type==="compound"){var r=n[0];if(r){if(Mt(r))return r.key}else return{}}var i={};return n.forEach(function(a){i[a.key]=Ve(a,e)}),i}function ue(t){var e,n,r=new Map;try{for(var i=b(t),a=i.next();!a.done;a=i.next()){var o=a.value;r.has(o)||r.set(o,[]),o.parent&&(r.has(o.parent)||r.set(o.parent,[]),r.get(o.parent).push(o))}}catch(u){e={error:u}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function er(t,e){var n=et([t],e);return Ve(t,ue(n))}function kt(t,e){return Array.isArray(t)?t.some(function(n){return n===e}):t instanceof Set?t.has(e):!1}function nr(t){return I([],O(new Set(D(I([],O(t.map(function(e){return e.ownEvents})),!1)))),!1)}function pt(t,e){return e.type==="compound"?tt(e).some(function(n){return n.type==="final"&&kt(t,n)}):e.type==="parallel"?tt(e).every(function(n){return pt(t,n)}):!1}function rr(t){return t===void 0&&(t=[]),t.reduce(function(e,n){return n.meta!==void 0&&(e[n.id]=n.meta),e},{})}function Ke(t){return new Set(D(t.map(function(e){return e.tags})))}function Qe(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(E(t)||E(e))return t===e;var n=j(t),r=j(e);return n.length===r.length&&n.every(function(i){return Qe(t[i],e[i])})}function ir(t){return E(t)?!1:"value"in t&&"history"in t}function ar(t,e){var n=t.exec,r=v(v({},t),{exec:n!==void 0?function(){return n(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return r}var Y=function(){function t(e){var n=this,r;this.actions=[],this.activities=De,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||De,this.meta=rr(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return nr(n.configuration)}})}return t.from=function(e,n){if(e instanceof t)return e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=Rt;return new t({value:e,context:n,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var r=Rt;return new t({value:e.value,context:n,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(e,n){var r=this;if(e===void 0&&(e=this.value),n===void 0&&(n="."),E(e))return[e];var i=j(e);return i.concat.apply(i,I([],O(i.map(function(a){return r.toStrings(e[a],n).map(function(o){return a+n+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var n=e.tags;e.machine;var r=Vt(e,["configuration","transitions","tags","machine"]);return v(v({},r),{tags:Array.from(n)})},t.prototype.matches=function(e){return Qt(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var n;return lt(!!this.machine),!!((n=this.machine)===null||n===void 0?void 0:n.transition(this,e).changed)},t}(),yt=function(t,e){var n=e(t);return n};function Ze(t){return{id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}}}function or(t,e,n,r){var i,a=Ue(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[a.type],u=t.data?At(t.data,n,r):void 0,s=o?sr(o,t.id,u):Ze(t.id);return s.meta=t,s}function sr(t,e,n){var r=Ze(e);if(r.deferred=!0,X(t)){var i=r.state=yt(void 0,function(){return(n?t.withContext(n):t).initialState});r.getSnapshot=function(){return i}}return r}function ur(t){try{return typeof t.send=="function"}catch{return!1}}function fr(t){return ur(t)&&"id"in t}function cr(t){return v({subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},t)}function lr(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function Ft(t){return v(v({type:ie},t),{toJSON:function(){t.onDone,t.onError;var e=Vt(t,["onDone","onError"]);return v(v({},e),{type:ie,src:lr(t.src)})}})}var nt="",fe="#",gt="*",rt={},it=function(t){return t[0]===fe},hr=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},dr=function(t,e,n){var r=n.slice(0,-1).some(function(a){return!("cond"in a)&&!("in"in a)&&(E(a.target)||X(a.target))}),i=e===nt?"the transient event":"event '".concat(e,"'");lt(!r,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},vr=function(){function t(e,n,r){var i=this;r===void 0&&(r="context"in e?e.context:void 0);var a;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(hr(),n),this.parent=this.options._parent,this.key=this.config.key||this.options._key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:je),this.id=this.config.id||I([this.machine.key],O(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&j(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(a=this.config.schema)!==null&&a!==void 0?a:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?ct(this.config.states,function(s,f){var l,h=new t(s,{_parent:i,_key:f});return Object.assign(i.idMap,v((l={},l[h.id]=h,l),h.idMap)),h}):rt;var o=0;function u(s){var f,l;s.order=o++;try{for(var h=b(tt(s)),c=h.next();!c.done;c=h.next()){var d=c.value;u(d)}}catch(y){f={error:y}}finally{try{c&&!c.done&&(l=h.return)&&l.call(h)}finally{if(f)throw f.error}}}u(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(s){var f=s.event;return f===nt}):nt in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=U(this.config.entry||this.config.onEntry).map(function(s){return dt(s)}),this.onExit=U(this.config.exit||this.config.onExit).map(function(s){return dt(s)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=U(this.config.invoke).map(function(s,f){var l,h;if(X(s))return i.machine.options.services=v((l={},l[s.id]=s,l),i.machine.options.services),Ft({src:s.id,id:s.id});if(E(s.src))return Ft(v(v({},s),{id:s.id||s.src,src:s.src}));if(X(s.src)||$(s.src)){var c="".concat(i.id,":invocation[").concat(f,"]");return i.machine.options.services=v((h={},h[c]=s.src,h),i.machine.options.services),Ft(v(v({id:c},s),{src:c}))}else{var d=s.src;return Ft(v(v({id:d.type},s),{src:d}))}}),this.activities=U(this.config.activities).concat(this.invoke).map(function(s){return oe(s)}),this.transition=this.transition.bind(this),this.tags=U(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||He(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,n){var r=this.options,i=r.actions,a=r.activities,o=r.guards,u=r.services,s=r.delays;return new t(this.config,{actions:v(v({},i),e.actions),activities:v(v({},a),e.activities),guards:v(v({},o),e.guards),services:v(v({},u),e.services),delays:v(v({},s),e.delays)},n!=null?n:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return $(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:ct(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(n,r){return n[r.eventType]=n[r.eventType]||[],n[r.eventType].push(r),n},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var n=e===nt,r=this.transitions.filter(function(i){var a=i.eventType===e;return n?a:a||i.eventType===gt});return this.__cache.candidates[e]=r,r},t.prototype.getDelayedTransitions=function(){var e=this,n=this.config.after;if(!n)return[];var r=function(a,o){var u=$(a)?"".concat(e.id,":delay[").concat(o,"]"):a,s=tr(u,e.id);return e.onEntry.push(We(s,{delay:a})),e.onExit.push(Vn(s)),s},i=Q(n)?n.map(function(a,o){var u=r(a.delay,o);return v(v({},a),{event:u})}):D(j(n).map(function(a,o){var u=n[a],s=E(u)?{target:u}:u,f=isNaN(+a)?a:+a,l=r(f,o);return U(s).map(function(h){return v(v({},h),{event:l,delay:f})})}));return i.map(function(a){var o=a.delay;return v(v({},e.formatTransition(a)),{delay:o})})},t.prototype.getStateNodes=function(e){var n,r=this;if(!e)return[];var i=e instanceof Y?e.value:ft(e,this.delimiter);if(E(i)){var a=this.getStateNode(i).initial;return a!==void 0?this.getStateNodes((n={},n[i]=a,n)):[this,this.states[i]]}var o=j(i),u=o.map(function(s){return r.getStateNode(s)});return u.push(this),u.concat(o.reduce(function(s,f){var l=r.getStateNode(f).getStateNodes(i[f]);return s.concat(l)},[]))},t.prototype.handles=function(e){var n=Re(e);return this.events.includes(n)},t.prototype.resolveState=function(e){var n=Array.from(et([],this.getStateNodes(e.value)));return new Y(v(v({},e),{value:this.resolve(e.value),configuration:n,done:pt(n,this),tags:Ke(n)}))},t.prototype.transitionLeafNode=function(e,n,r){var i=this.getStateNode(e),a=i.next(n,r);return!a||!a.transitions.length?this.next(n,r):a},t.prototype.transitionCompoundNode=function(e,n,r){var i=j(e),a=this.getStateNode(i[0]),o=a._transition(e[i[0]],n,r);return!o||!o.transitions.length?this.next(n,r):o},t.prototype.transitionParallelNode=function(e,n,r){var i,a,o={};try{for(var u=b(j(e)),s=u.next();!s.done;s=u.next()){var f=s.value,l=e[f];if(!!l){var h=this.getStateNode(f),c=h._transition(l,n,r);c&&(o[f]=c)}}}catch(g){i={error:g}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}var d=j(o).map(function(g){return o[g]}),y=D(d.map(function(g){return g.transitions})),m=d.some(function(g){return g.transitions.length>0});if(!m)return this.next(n,r);var p=D(d.map(function(g){return g.entrySet})),w=D(j(o).map(function(g){return o[g].configuration}));return{transitions:y,entrySet:p,exitSet:D(d.map(function(g){return g.exitSet})),configuration:w,source:n,actions:D(j(o).map(function(g){return o[g].actions}))}},t.prototype._transition=function(e,n,r){return E(e)?this.transitionLeafNode(e,n,r):j(e).length===1?this.transitionCompoundNode(e,n,r):this.transitionParallelNode(e,n,r)},t.prototype.next=function(e,n){var r,i,a=this,o=n.name,u=[],s=[],f;try{for(var l=b(this.getCandidates(o)),h=l.next();!h.done;h=l.next()){var c=h.value,d=c.cond,y=c.in,m=e.context,p=y?E(y)&&it(y)?e.matches(ft(this.getStateNodeById(y).path,this.delimiter)):Qt(ft(y,this.delimiter),Dn(this.path.slice(0,-2))(e.value)):!0,w=!1;try{w=!d||Be(this.machine,d,m,n,e)}catch(N){throw new Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(N.message))}if(w&&p){c.target!==void 0&&(s=c.target),u.push.apply(u,I([],O(c.actions),!1)),f=c;break}}}catch(N){r={error:N}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}if(!!f){if(!s.length)return{transitions:[f],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:u};var g=D(s.map(function(N){return a.getRelativeStateNodes(N,e.historyValue)})),_=!!f.internal,A=_?[]:D(g.map(function(N){return a.nodesFromChild(N)}));return{transitions:[f],entrySet:A,exitSet:_?[]:[this],configuration:g,source:e,actions:u}}},t.prototype.nodesFromChild=function(e){if(e.escapes(this))return[];for(var n=[],r=e;r&&r!==this;)n.push(r),r=r.parent;return n.push(this),n},t.prototype.escapes=function(e){if(this===e)return!1;for(var n=this.parent;n;){if(n===e)return!1;n=n.parent}return!0},t.prototype.getActions=function(e,n,r,i){var a,o,u,s,f=et([],i?this.getStateNodes(i.value):[this]),l=e.configuration.length?et(f,e.configuration):f;try{for(var h=b(l),c=h.next();!c.done;c=h.next()){var d=c.value;kt(f,d)||e.entrySet.push(d)}}catch(S){a={error:S}}finally{try{c&&!c.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}try{for(var y=b(f),m=y.next();!m.done;m=y.next()){var d=m.value;(!kt(l,d)||kt(e.exitSet,d.parent))&&e.exitSet.push(d)}}catch(S){u={error:S}}finally{try{m&&!m.done&&(s=y.return)&&s.call(y)}finally{if(u)throw u.error}}e.source||(e.exitSet=[],e.entrySet.push(this));var p=D(e.entrySet.map(function(S){var x=[];if(S.type!=="final")return x;var T=S.parent;if(!T.parent)return x;x.push(It(S.id,S.doneData),It(T.id,S.doneData?At(S.doneData,n,r):void 0));var R=T.parent;return R.type==="parallel"&&tt(R).every(function(C){return pt(e.configuration,C)})&&x.push(It(R.id)),x}));e.exitSet.sort(function(S,x){return x.order-S.order}),e.entrySet.sort(function(S,x){return S.order-x.order});var w=new Set(e.entrySet),g=new Set(e.exitSet),_=O([D(Array.from(w).map(function(S){return I(I([],O(S.activities.map(function(x){return Kn(x)})),!1),O(S.onEntry),!1)})).concat(p.map(Xn)),D(Array.from(g).map(function(S){return I(I([],O(S.onExit),!1),O(S.activities.map(function(x){return Qn(x)})),!1)}))],2),A=_[0],N=_[1],L=Lt(N.concat(e.actions).concat(A),this.machine.options.actions);return L},t.prototype.transition=function(e,n,r){e===void 0&&(e=this.initialState);var i=k(n),a;if(e instanceof Y)a=r===void 0?e:this.resolveState(Y.from(e,r));else{var o=E(e)?this.resolve($t(this.getResolvedPath(e))):this.resolve(e),u=r!=null?r:this.machine.context;a=this.resolveState(Y.from(o,u))}if(!ut&&i.name===gt)throw new Error("An event cannot have the wildcard type ('".concat(gt,"')"));if(this.strict&&!this.events.includes(i.name)&&!Ln(i.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(i.name,"'"));var s=this._transition(a.value,a,i)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:a,actions:[]},f=et([],this.getStateNodes(a.value)),l=s.configuration.length?et(f,s.configuration):f;return s.configuration=I([],O(l),!1),this.resolveTransition(s,a,i)},t.prototype.resolveRaisedTransition=function(e,n,r){var i,a=e.actions;return e=this.transition(e,n),e._event=r,e.event=r.data,(i=e.actions).unshift.apply(i,I([],O(a),!1)),e},t.prototype.resolveTransition=function(e,n,r,i){var a,o,u=this;r===void 0&&(r=Rt),i===void 0&&(i=this.machine.context);var s=e.configuration,f=!n||e.transitions.length>0,l=f?er(this.machine,s):void 0,h=n?n.historyValue?n.historyValue:e.source?this.machine.historyValue(n.value):void 0:void 0,c=n?n.context:i,d=this.getActions(e,c,r,n),y=n?v({},n.activities):{};try{for(var m=b(d),p=m.next();!p.done;p=m.next()){var w=p.value;w.type===ee?y[w.activity.id||w.activity.type]=w:w.type===ne&&(y[w.activity.id||w.activity.type]=!1)}}catch(z){a={error:z}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}var g=O(se(this,n,c,r,d,this.machine.config.preserveActionOrder),2),_=g[0],A=g[1],N=O(Me(_,function(z){return z.type===jt||z.type===Dt&&z.to===ht.Internal}),2),L=N[0],S=N[1],x=_.filter(function(z){var W;return z.type===ee&&((W=z.activity)===null||W===void 0?void 0:W.type)===ie}),T=x.reduce(function(z,W){return z[W.activity.id]=or(W.activity,u.machine,A,r),z},n?v({},n.children):{}),R=l?e.configuration:n?n.configuration:[],C=pt(R,this),M=new Y({value:l||n.value,context:A,_event:r,_sessionid:n?n._sessionid:null,historyValue:l?h?Cn(h,l):void 0:n?n.historyValue:void 0,history:!l||e.source?n:void 0,actions:l?S:[],activities:l?y:n?n.activities:{},events:[],configuration:R,transitions:e.transitions,children:T,done:C,tags:n==null?void 0:n.tags,machine:this}),mt=c!==A;M.changed=r.name===Ye||mt;var J=M.history;J&&delete J.history;var he=!C&&(this._transient||s.some(function(z){return z._transient}));if(!f&&(!he||r.name===nt))return M;var F=M;if(!C)for(he&&(F=this.resolveRaisedTransition(F,{type:Bn},r));L.length;){var en=L.shift();F=this.resolveRaisedTransition(F,en._event,r)}var nn=F.changed||(J?!!F.actions.length||mt||typeof J.value!=typeof F.value||!Qe(F.value,J.value):void 0);return F.changed=nn,F.history=J,F.tags=Ke(F.configuration),F},t.prototype.getStateNode=function(e){if(it(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var n=this.states[e];if(!n)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return n},t.prototype.getStateNodeById=function(e){var n=it(e)?e.slice(fe.length):e;if(n===this.id)return this;var r=this.machine.idMap[n];if(!r)throw new Error("Child state node '#".concat(n,"' does not exist on machine '").concat(this.id,"'"));return r},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&it(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var n=Zt(e,this.delimiter).slice(),r=this;n.length;){var i=n.shift();if(!i.length)break;r=r.getStateNode(i)}return r},t.prototype.resolve=function(e){var n,r=this;if(!e)return this.initialStateValue||rt;switch(this.type){case"parallel":return ct(this.initialStateValue,function(a,o){return a?r.getStateNode(o).resolve(e[o]||a):rt});case"compound":if(E(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(n={},n[e]=i.initialStateValue,n):e}return j(e).length?ct(e,function(a,o){return a?r.getStateNode(o).resolve(a):rt}):this.initialStateValue||{};default:return e||rt}},t.prototype.getResolvedPath=function(e){if(it(e)){var n=this.machine.idMap[e.slice(fe.length)];if(!n)throw new Error("Unable to find state node '".concat(e,"'"));return n.path}return Zt(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var n;if(this.type==="parallel")n=Le(this.states,function(r){return r.initialStateValue||rt},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));n=Mt(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else n={};return this.__cache.initialStateValue=n,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,n){var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,entrySet:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,n)},Object.defineProperty(t.prototype,"initialState",{get:function(){this._init();var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var n=this.config;E(n.target)?e=it(n.target)?$t(this.machine.getStateNodeById(n.target).path.slice(this.path.length-1)):n.target:e=n.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,n,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(n):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(Mt(this))return[this];if(this.type==="compound"&&!this.initial)return ut||lt(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var n=Pt(this.initialStateValue);return D(n.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var n=O(e),r=n[0],i=n.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var a=this.getStateNode(r);if(a.type==="history")return a.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(!!j(this.states).length)return{current:e||this.initialStateValue,states:Le(this.states,function(n,r){if(!e)return n.historyValue();var i=E(e)?void 0:e[r];return n.historyValue(i||n.initialStateValue)},function(n){return!n.history})}},t.prototype.resolveHistory=function(e){var n=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var i=this.target;return i?D(Pt(i).map(function(o){return r.getFromRelativePath(o)})):r.initialStateNodes}var a=Rn(r.path,"states")(e).current;return E(a)?[r.getStateNode(a)]:D(Pt(a).map(function(o){return n.history==="deep"?r.getFromRelativePath(o):[r.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,n=D(j(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,n,r,i;if(this.__cache.events)return this.__cache.events;var a=this.states,o=new Set(this.ownEvents);if(a)try{for(var u=b(j(a)),s=u.next();!s.done;s=u.next()){var f=s.value,l=a[f];if(l.states)try{for(var h=(r=void 0,b(l.events)),c=h.next();!c.done;c=h.next()){var d=c.value;o.add("".concat(d))}}catch(y){r={error:y}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}}}catch(y){e={error:y}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(n){return!(!n.target&&!n.actions.length&&n.internal)}).map(function(n){return n.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var n=this;if(e!==void 0)return e.map(function(r){if(!E(r))return r;var i=r[0]===n.delimiter;if(i&&!n.parent)return n.getStateNodeByPath(r.slice(1));var a=i?n.key+r:r;if(n.parent)try{var o=n.parent.getStateNodeByPath(a);return o}catch(u){throw new Error("Invalid transition definition for state node '".concat(n.id,`':
`).concat(u.message))}else return n.getStateNodeByPath(a)})},t.prototype.formatTransition=function(e){var n=this,r=zn(e.target),i="internal"in e?e.internal:r?r.some(function(s){return E(s)&&s[0]===n.delimiter}):!0,a=this.machine.options.guards,o=this.resolveTarget(r),u=v(v({},e),{actions:Lt(U(e.actions)),cond:ze(e.cond,a),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return v(v({},u),{target:u.target?u.target.map(function(s){return"#".concat(s.id)}):void 0,source:"#".concat(n.id)})}});return u},t.prototype.formatTransitions=function(){var e,n,r=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var a=this.config.on,o=gt,u=a[o],s=u===void 0?[]:u,f=Vt(a,[typeof o=="symbol"?o:o+""]);i=D(j(f).map(function(g){!ut&&g===nt&&lt(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(r.id,'".'));var _=Z(g,f[g]);return ut||dr(r,g,_),_}).concat(Z(gt,s)))}var l=this.config.always?Z("",this.config.always):[],h=this.config.onDone?Z(String(It(this.id)),this.config.onDone):[];ut||lt(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var c=D(this.invoke.map(function(g){var _=[];return g.onDone&&_.push.apply(_,I([],O(Z(String(Ct(g.id)),g.onDone)),!1)),g.onError&&_.push.apply(_,I([],O(Z(String(vt(g.id)),g.onError)),!1)),_})),d=this.after,y=D(I(I(I(I([],O(h),!1),O(c),!1),O(i),!1),O(l),!1).map(function(g){return U(g).map(function(_){return r.formatTransition(_)})}));try{for(var m=b(d),p=m.next();!p.done;p=m.next()){var w=p.value;y.push(w)}}catch(g){e={error:g}}finally{try{p&&!p.done&&(n=m.return)&&n.call(m)}finally{if(e)throw e.error}}return y},t}();function ii(t,e){return new vr(t,e)}var pr={deferEvents:!1},tn=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=v(v({},pr),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(n){throw this.clear(),n}finally{this.processingEvent=!1}},t}(),ce=new Map,yr=0,zt={bookId:function(){return"x:".concat(yr++)},register:function(t,e){return ce.set(t,e),t},get:function(t){return ce.get(t)},free:function(t){ce.delete(t)}};function le(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global}function gr(){var t=le();if(t&&"__xstate__"in t)return t.__xstate__}function mr(t){if(!!le()){var e=gr();e&&e.register(t)}}function xr(t,e){e===void 0&&(e={});var n=t.initialState,r=new Set,i=[],a=!1,o=function(){if(!a){for(a=!0;i.length>0;){var f=i.shift();n=t.transition(n,f,s),r.forEach(function(l){return l.next(n)})}a=!1}},u=cr({id:e.id,send:function(f){i.push(f),o()},getSnapshot:function(){return n},subscribe:function(f,l,h){var c=qe(f,l,h);return r.add(c),c.next(n),{unsubscribe:function(){r.delete(c)}}}}),s={parent:e.parent,self:u,id:e.id||"anonymous",observers:r};return n=t.start?t.start(s):n,u}var wr={sync:!1,autoForward:!1},B;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(B||(B={}));var _r=function(){function t(e,n){var r=this;n===void 0&&(n=t.defaultOptions),this.machine=e,this.scheduler=new tn,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=B.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(l,h){if(Q(l))return r.batch(l),r.state;var c=k(te(l,h));if(r.status===B.Stopped)return r.state;if(r.status!==B.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(c.name,'" was sent to uninitialized service "').concat(r.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(c.data)));return r.scheduler.schedule(function(){r.forward(c);var d=r.nextState(c);r.update(d,c)}),r._state},this.sendTo=function(l,h){var c=r.parent&&(h===ht.Parent||r.parent.id===h),d=c?r.parent:E(h)?r.children.get(h)||zt.get(h):Fn(h)?h:void 0;if(!d){if(!c)throw new Error("Unable to send event to child '".concat(h,"' from service '").concat(r.id,"'."));return}"machine"in d?d.send(v(v({},l),{name:l.name===qn?"".concat(vt(r.id)):l.name,origin:r.sessionId})):d.send(l.data)};var i=v(v({},t.defaultOptions),n),a=i.clock,o=i.logger,u=i.parent,s=i.id,f=s!==void 0?s:e.id;this.id=f,this.logger=o,this.clock=a,this.parent=u,this.options=i,this.scheduler=new tn({deferEvents:this.options.deferEvents}),this.sessionId=zt.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:yt(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,n){var r,i;try{for(var a=b(e.actions),o=a.next();!o.done;o=a.next()){var u=o.value;this.exec(u,e,n)}}catch(s){r={error:s}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.update=function(e,n){var r,i,a,o,u,s,f,l,h=this;if(e._sessionid=this.sessionId,this._state=e,this.options.execute&&this.execute(this.state),this.children.forEach(function(T){h.state.children[T.id]=T}),this.devTools&&this.devTools.send(n.data,e),e.event)try{for(var c=b(this.eventListeners),d=c.next();!d.done;d=c.next()){var y=d.value;y(e.event)}}catch(T){r={error:T}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}try{for(var m=b(this.listeners),p=m.next();!p.done;p=m.next()){var y=p.value;y(e,e.event)}}catch(T){a={error:T}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}try{for(var w=b(this.contextListeners),g=w.next();!g.done;g=w.next()){var _=g.value;_(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(T){u={error:T}}finally{try{g&&!g.done&&(s=w.return)&&s.call(w)}finally{if(u)throw u.error}}var A=pt(e.configuration||[],this.machine);if(this.state.configuration&&A){var N=e.configuration.find(function(T){return T.type==="final"&&T.parent===h.machine}),L=N&&N.doneData?At(N.doneData,e.context,n):void 0;try{for(var S=b(this.doneListeners),x=S.next();!x.done;x=S.next()){var y=x.value;y(Ct(this.id,L))}}catch(T){f={error:T}}finally{try{x&&!x.done&&(l=S.return)&&l.call(S)}finally{if(f)throw f.error}}this.stop()}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===B.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,n,r){var i=this;if(!e)return{unsubscribe:function(){}};var a,o=r;return typeof e=="function"?a=e:(a=e.next.bind(e),o=e.complete.bind(e)),this.listeners.add(a),this.status===B.Running&&a(this.state),o&&this.onDone(o),{unsubscribe:function(){a&&i.listeners.delete(a),o&&i.doneListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var n=this;if(this.status===B.Running)return this;zt.register(this.sessionId,this),this.initialized=!0,this.status=B.Running;var r=e===void 0?this.initialState:yt(this,function(){return ir(e)?n.machine.resolveState(e):n.machine.resolveState(Y.from(e,n.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){n.update(r,Rt)}),this},t.prototype.stop=function(){var e,n,r,i,a,o,u,s,f,l,h=this;try{for(var c=b(this.listeners),d=c.next();!d.done;d=c.next()){var y=d.value;this.listeners.delete(y)}}catch(x){e={error:x}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}try{for(var m=b(this.stopListeners),p=m.next();!p.done;p=m.next()){var y=p.value;y(),this.stopListeners.delete(y)}}catch(x){r={error:x}}finally{try{p&&!p.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}try{for(var w=b(this.contextListeners),g=w.next();!g.done;g=w.next()){var y=g.value;this.contextListeners.delete(y)}}catch(x){a={error:x}}finally{try{g&&!g.done&&(o=w.return)&&o.call(w)}finally{if(a)throw a.error}}try{for(var _=b(this.doneListeners),A=_.next();!A.done;A=_.next()){var y=A.value;this.doneListeners.delete(y)}}catch(x){u={error:x}}finally{try{A&&!A.done&&(s=_.return)&&s.call(_)}finally{if(u)throw u.error}}if(!this.initialized)return this;this.state.configuration.forEach(function(x){var T,R;try{for(var C=b(x.definition.exit),M=C.next();!M.done;M=C.next()){var mt=M.value;h.exec(mt,h.state)}}catch(J){T={error:J}}finally{try{M&&!M.done&&(R=C.return)&&R.call(C)}finally{if(T)throw T.error}}}),this.children.forEach(function(x){$(x.stop)&&x.stop()});try{for(var N=b(j(this.delayedEventsMap)),L=N.next();!L.done;L=N.next()){var S=L.value;this.clock.clearTimeout(this.delayedEventsMap[S])}}catch(x){f={error:x}}finally{try{L&&!L.done&&(l=N.return)&&l.call(N)}finally{if(f)throw f.error}}return this.scheduler.clear(),this.initialized=!1,this.status=B.Stopped,zt.free(this.sessionId),this},t.prototype.batch=function(e){var n=this;if(!(this.status===B.NotStarted&&this.options.deferEvents)){if(this.status!==B.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}this.scheduler.schedule(function(){var r,i,a=n.state,o=!1,u=[],s=function(c){var d=k(c);n.forward(d),a=yt(n,function(){return n.machine.transition(a,d)}),u.push.apply(u,I([],O(a.actions.map(function(y){return ar(y,a)})),!1)),o=o||!!a.changed};try{for(var f=b(e),l=f.next();!l.done;l=f.next()){var h=l.value;s(h)}}catch(c){r={error:c}}finally{try{l&&!l.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}a.changed=o,a.actions=u,n.update(a,k(e[e.length-1]))})},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype.nextState=function(e){var n=this,r=k(e);if(r.name.indexOf(Xe)===0&&!this.state.nextEvents.some(function(a){return a.indexOf(Xe)===0}))throw r.data.data;var i=yt(this,function(){return n.machine.transition(n.state,r)});return i},t.prototype.forward=function(e){var n,r;try{for(var i=b(this.forwardTo),a=i.next();!a.done;a=i.next()){var o=a.value,u=this.children.get(o);if(!u)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));u.send(e)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.defer=function(e){var n=this;this.delayedEventsMap[e.id]=this.clock.setTimeout(function(){e.to?n.sendTo(e._event,e.to):n.send(e._event)},e.delay)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,n,r){r===void 0&&(r=this.machine.options.actions);var i=n.context,a=n._event,o=e.exec||ae(e.type,r),u=$(o)?o:o?o.exec:e.exec;if(u)try{return u(i,a.data,{action:e,state:this.state,_event:a})}catch(A){throw this.parent&&this.parent.send({type:"xstate.error",data:A}),A}switch(e.type){case Dt:var s=e;if(typeof s.delay=="number"){this.defer(s);return}else s.to?this.sendTo(s._event,s.to):this.send(s._event);break;case Je:this.cancel(e.sendId);break;case ee:{var f=e.activity;if(!this.state.activities[f.id||f.type])break;if(f.type===P.Invoke){var l=Ue(f.src),h=this.machine.options.services?this.machine.options.services[l.type]:void 0,c=f.id,d=f.data,y="autoForward"in f?f.autoForward:!!f.forward;if(!h)return;var m=d?At(d,i,a):void 0;if(typeof h=="string")return;var p=$(h)?h(i,a.data,{data:m,src:l,meta:f.meta}):h;if(!p)return;var w=void 0;X(p)&&(p=m?p.withContext(m):p,w={autoForward:y}),this.spawn(p,c,w)}else this.spawnActivity(f);break}case ne:{this.stopChild(e.activity.id);break}case Ge:var g=e.label,_=e.value;g?this.logger(g,_):this.logger(_);break}},t.prototype.removeChild=function(e){var n;this.children.delete(e),this.forwardTo.delete(e),(n=this.state)===null||n===void 0||delete n.children[e]},t.prototype.stopChild=function(e){var n=this.children.get(e);!n||(this.removeChild(e),$(n.stop)&&n.stop())},t.prototype.spawn=function(e,n,r){if(Ce(e))return this.spawnPromise(Promise.resolve(e),n);if($(e))return this.spawnCallback(e,n);if(fr(e))return this.spawnActor(e,n);if(Mn(e))return this.spawnObservable(e,n);if(X(e))return this.spawnMachine(e,v(v({},r),{id:n}));if(In(e))return this.spawnBehavior(e,n);throw new Error('Unable to spawn entity "'.concat(n,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,n){var r=this;n===void 0&&(n={});var i=new t(e,v(v({},this.options),{parent:this,id:n.id||e.id})),a=v(v({},wr),n);a.sync&&i.onTransition(function(u){r.send(Ye,{state:u,id:i.id})});var o=i;return this.children.set(i.id,o),a.autoForward&&this.forwardTo.add(i.id),i.onDone(function(u){r.removeChild(i.id),r.send(k(u,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,n){var r=xr(e,{id:n,parent:this});return this.children.set(n,r),r},t.prototype.spawnPromise=function(e,n){var r=this,i=!1,a;e.then(function(u){i||(a=u,r.removeChild(n),r.send(k(Ct(n,u),{origin:n})))},function(u){if(!i){r.removeChild(n);var s=vt(n,u);try{r.send(k(s,{origin:n}))}catch{r.devTools&&r.devTools.send(s,r.state),r.machine.strict&&r.stop()}}});var o={id:n,send:function(){},subscribe:function(u,s,f){var l=qe(u,s,f),h=!1;return e.then(function(c){h||(l.next(c),!h&&l.complete())},function(c){h||l.error(c)}),{unsubscribe:function(){return h=!0}}},stop:function(){i=!0},toJSON:function(){return{id:n}},getSnapshot:function(){return a}};return this.children.set(n,o),o},t.prototype.spawnCallback=function(e,n){var r=this,i=!1,a=new Set,o=new Set,u,s=function(h){u=h,o.forEach(function(c){return c(h)}),!i&&r.send(k(h,{origin:n}))},f;try{f=e(s,function(h){a.add(h)})}catch(h){this.send(vt(n,h))}if(Ce(f))return this.spawnPromise(f,n);var l={id:n,send:function(h){return a.forEach(function(c){return c(h)})},subscribe:function(h){return o.add(h),{unsubscribe:function(){o.delete(h)}}},stop:function(){i=!0,$(f)&&f()},toJSON:function(){return{id:n}},getSnapshot:function(){return u}};return this.children.set(n,l),l},t.prototype.spawnObservable=function(e,n){var r=this,i,a=e.subscribe(function(u){i=u,r.send(k(u,{origin:n}))},function(u){r.removeChild(n),r.send(k(vt(n,u),{origin:n}))},function(){r.removeChild(n),r.send(k(Ct(n),{origin:n}))}),o={id:n,send:function(){},subscribe:function(u,s,f){return e.subscribe(u,s,f)},stop:function(){return a.unsubscribe()},getSnapshot:function(){return i},toJSON:function(){return{id:n}}};return this.children.set(n,o),o},t.prototype.spawnActor=function(e,n){return this.children.set(n,e),e},t.prototype.spawnActivity=function(e){var n=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!!n){var r=n(this.state.context,e);this.spawnEffect(e.id,r)}},t.prototype.spawnEffect=function(e,n){this.children.set(e,{id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:n||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})},t.prototype.attachDev=function(){var e=le();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var n=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(v(v({name:this.id,autoPause:!0,stateSanitizer:function(r){return{value:r.value,context:r.context,actions:r.actions}}},n),{features:v({jump:!1,skip:!1},n?n.features:void 0)}),this.machine),this.devTools.init(this.state)}mr(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[kn]=function(){return this},t.prototype.getSnapshot=function(){return this.status===B.NotStarted?this.initialState:this._state},t.defaultOptions=function(e){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(n,r){return setTimeout(n,r)},clearTimeout:function(n){return clearTimeout(n)}},logger:e.console.log.bind(console),devTools:!1}}(typeof self!="undefined"?self:global),t.interpret=Sr,t}();function Sr(t,e){var n=new _r(t,e);return n}function ai(t){return t*t*t*t*t}function oi(t){return--t*t*t*t*t+1}function si(t,{delay:e=0,duration:n=400,easing:r=Bt}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:a=>`opacity: ${a*i}`}}export{zr as $,Br as A,rn as B,ni as C,pn as D,Lr as E,H as F,Er as G,Tr as H,Or as I,$r as J,Nr as K,ii as L,ri as M,Sr as N,gn as O,Mr as P,q as Q,jr as R,ei as S,qr as T,br as U,ot as V,Wr as W,ai as X,si as Y,Hr as Z,oi as _,mn as a,Pr as a0,Ir as b,Cr as c,yn as d,_e as e,Ar as f,wn as g,Fr as h,ti as i,Qr as j,Dr as k,Rr as l,Zr as m,kr as n,On as o,Vr as p,Kr as q,Gr as r,an as s,Jt as t,Yr as u,$n as v,Xr as w,Nn as x,Jr as y,Ur as z};
